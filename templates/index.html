<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <title>RedditSearch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="/static/bootstrap/css/bootstrap.min.Flatstrap.css" rel="stylesheet">
    <link href="/static/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,400italic' rel='stylesheet' type='text/css'>
    <link href="/static/style.css" rel="stylesheet">

    <link href="/static/animate.css" rel="stylesheet">

</head>



<body ng-app="RedditSearchApplication">

<div class="container" ng-controller="MainController">
    
    <div class="page-header">
        <h1>
            Reddit Search <small>Can't find that post?</small>
        </h1>
    </div>

    <div class="row-fluid">
        <div class="span4">
            <div class="well well-large">
                
                <ul class="nav nav-tabs">
                    <li ng-class="redditSearch.mode == 'userpage' ? 'active' : ''">
                        <a href="" ng-click="redditSearch.mode = 'userpage'">By user page</a>
                    </li>
                    <li ng-class="redditSearch.mode == 'subreddit' ? 'active' : ''">
                        <a href="" ng-click="redditSearch.mode = 'subreddit'">By subreddit</a>
                    </li>
                </ul>
                
                <form novalidate onsubmit="return false">
                    <div ng-switch on="redditSearch.mode">
                        <div ng-switch-when="userpage">
                            <label for="">Username:</label>
                            <input type="text" class="input span12" ng-model="mainQueryData.pending_data.username"></input>
                            <label for="">Feed:</label>
                            <select class="span12" name="" ng-model="mainQueryData.pending_data.userpage">
                                <option value="liked">Liked</option>
                                <option value="submitted">Submitted</option>
                                <option value="disliked">Disliked</option>
                            </select>
                        </div>
                        <div ng-switch-when="subreddit">
                            <label for="">Subreddit (can be multi):</label>
                            <input type="text" class="input span12" ng-model="mainQueryData.pending_data.subreddit"></input>
                            <label for="">Feed sorting type:</label>
                            <select class="span12" name="" ng-model="mainQueryData.pending_data.subreddit_feed">
                                <option value="new">New</option>
                                <option value="hot">Hot</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-block btn-info" ng-click="toggleSearch()">
                        <span ng-if="redditSearch.isBusy()">Stop</span>
                        <span ng-if="!redditSearch.isBusy()">Start</span>
                    </button>
                </form>

                <hr>

                <h4>
                    Filter results: 
                </h4>

                <p class="muted">
                    <span ng-class="(getTotalFilteredPosts() == 300) ? 'emph' : ''">
                        {{getTotalFilteredPosts()}}
                    </span>
                    <span ng-if="getTotalFilteredPosts() == 300"> + </span>
                    results out of {{redditSearch.searchState.totalPostsRetrieved}} retrieved
                    <span class="muted" ng-if="redditSearch.searchState.reachedRedditLimit">(Last page)</span>
                    <img class ="hspace20" src="/static/ajax-loader.gif" ng-if="redditSearch.isBusy()">
                </p>

                <hr>
                

                <form novalidate>
                    <label for="">Subreddit:</label>
                    <input class="span12" type="text" ng-model="postFilter.subreddit">
                    <label for="">Title contains:</label>
                    <input class="span12" type="text" ng-model="postFilter.title">
                    <label for="">Domain:</label>
                    <input class="span12" type="text" ng-model="postFilter.domain">
                    <label for="">Original poster:</label>
                    <input class="span12" type="text" ng-model="postFilter.op">
                    <label for="">File extension:</label>
                    <input class="span12" type="text" ng-model="postFilter.extension">
                </form>


            </div>
        </div>



        <div class="span8">
            <div ng-if="redditSearch.searchState.error" ng-animate="{enter: 'animated fadeInDown'}">
                <div ng-switch on="redditSearch.searchState.error" class="alert alert-error">
                    <div ng-switch-when="no_page">
                        <p> Timeout (or no such page) </p>
                        <p> You may be trying to access your /liked or /disliked feeds without them being public in Reddit's settings </p>
                    </div>
                    <div ng-switch-default>
                        <p> An unknown error occured </p>
                    </div>
                </div>    
            </div>

            <div ng-repeat="monthGroup in filteredData">
                
                <div ng-if="monthGroup.items.length > 0">
                    <div class="alert alert-info">
                        {{monthGroup.id.format('MMMM YYYY')}}
                    </div>
                    
                    <table class="table tabled-bordered table-striped custom-table">
                        <tbody>
                            <tr ng-repeat="post in monthGroup.items">
                                <td>
                                    <a href="{{post.link}}">
                                        <img class="custom-thumb with-border" src="{{post.thumbnail}}" onerror="imgError(this)">
                                    </a>
                                </td>
                    
                                <td>
                                    <p class="ellipsis">
                                        <a href="{{post.comments}}">{{post.title}}</a>
                                    </p>
                                    <p>
                                        <i>{{post.domain}} &nbsp; {{getDisplayTextForExtension(post)}}</i>
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            
            </div>            
            

        </div>
    </div>

</div>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.0.0/moment.min.js"></script>

<script src="/static/RedditSearch.js"></script>
<script src="/static/Application.js"></script>

<script>

    function imgError(image) {
        image.onerror = ""
        image.src = "/static/noimage.png"
        return true
    }

</script>

</body>



</html>